\ProvidesPackage{unn-titlepage}
\RequirePackage{geometry}
\RequirePackage{etoolbox}
\newcommand*\ulfill{\mbox{}\leaders\hrule depth 2pt height -1.5pt\hfill} % similar to an underline
% Confirm text

\csdef{Title@InstituteName}{
    \MakeUppercase{
        МИНИСТЕРСТВО НАУКИ И ВЫСШЕГО ОБРАЗОВАНИЯ \\
        РОССИЙСКОЙ ФЕДЕРАЦИИ \\
    }
    \vspace{1em}
    Федеральное государственное автономное образовательное учреждение \\
    высшего образования \\
    <<Национальный исследовательский \\
    Нижегородский государственный университет им. Н.И. Лобачевского>>
}


\csdef{Title@Department}{%
    Радиофизический факультет
}

\csdef{Title@Field}{Радиофизика}

\csdef{Title@FieldNumber}{%
    03.04.03
}

\csdef{Title@Specialization}{Статистическая радиофизика}

\csdef{Title@WorkType}{Выпускная квалификационная работа}

\csdef{Title@WorkTypeSmall}{}


\csdef{Title@WorkTitle}{
Название выпускной квалификационной работы
}

\csdef{Title@Confirm}{<<К защите допущен>>:}


\csdef{Title@Date}{2022 год}

\csdef{Title@City}{Нижний Новгород}

\def\maketitle{\titlepage}

\newcounter{cnt}
\newcommand\addauthor[2]{%
  \stepcounter{cnt}%
  \csdef{post\thecnt}{#1}
  \csdef{author\thecnt}{#2}
%   \listcsadd{posts}{\csuse{post\thecnt}}
%   \listcsadd{authors}{\csuse{author\thecnt}}
  \listcsadd{posts}{#1}
  \listcsadd{authors}{#2}
}

\newcommand\getauthor[1]{%
  \csuse{post#1}
  \csuse{author#1}
}

\newcommand\setauthor[3]{%
  \csdef{post#1}{#2}
  \csdef{author#1}{#3}
}

\newcounter{i}
\newcommand\clearauthors{
    \setcounter{i}{1}
    \loop
    \ifnum \value{i}<\thecnt
    \csundef{post\thei}
    \csundef{author\thei}
    \addtocounter{i}{1}
    \repeat
    \setcounter{cnt}{0}
}

\addauthor{Зав. кафедрой статистической радиофизики  \\ и мобильных систем связи,  \\ профессор, д.ф.–м.н.}{Мальцев А.А.}
\addauthor{Научный руководитель,  \\ профессор, д.ф.-м.н}{Мальцев А.А.}
\addauthor{Рецензент,  \\ доцент, к.ф-м.н.}{Михеев П.В.}
\addauthor{Консультант по технике безопасности,  \\ доцент, к.ф.-м.н.}{Клемина А.В.}
\addauthor{Студент 2-го курса магистратуры}{Понур К.А.}



\renewenvironment*{titlepage}{
    \thispagestyle{empty}
    \newgeometry{left=30mm,right=15mm,top=15mm,bottom=15mm,bindingoffset=0cm,headheight=15pt}
    % \makebox[0pt][l]{%
    %     \raisebox{-\totalheight}[0pt][0pt]{%
    %     \hspace{-40mm}
    %     % \vspace{-40mm}
    %     \includegraphics{titlepage_2022}}
    % }%
    \begin{spacing}{1}
    \begin{center}
        
        \textbf{\Title@InstituteName} % name of Institute
        
    \end{center}

    \begin{center}
        \Title@Department
    \end{center}

    \begin{center}
        Направление~\Title@FieldNumber~<<\Title@Field>> \\
        \ifcsempty{Title@Specialization}{}{Направленность <<\Title@Specialization>>}
    \end{center}
    \vspace{2em}
    \begin{center}
        \MakeUppercase{\csuse{Title@WorkType}}

        \csuse{Title@WorkTypeSmall}
    \end{center}

    \begin{center}
        \MakeUppercase{\csuse{Title@WorkTitle}}
    \end{center}
    \vspace{1em}

    \vfill

    \setcounter{i}{1}
    \begin{flushleft}
        \ifcsempty{Title@Confirm}{}{\Title@Confirm \vspace{2em} \\}
        \loop
        \noindent 
        \parbox{0.64\linewidth}{\csuse{post\thei}}  \hfill 
        {\raggedright \makebox[2cm]{\ulfill}}
        \parbox{0.20\linewidth}{\raggedright \csuse{author\thei}} 
        \vspace{2em} \\
        \ifnum \value{i}<\thecnt
        \addtocounter{i}{1}
        \repeat
    \end{flushleft}
    \vfill
    \begin{center}
        \csuse{Title@City}\\
        \csuse{Title@Date}
    \end{center}
    \end{spacing}
    
            % \noindent \csuse{post\thei} \hfill \centering \makebox[3em]{\ulfill} \raggedright \csuse{author\thei} \hfill \vspace{1em} \\



    
    % \addtocounter{cnt}{-1}

    % \noindent \gettext{\thei} \thei/\thecnt \newline
}{}